<!-- templates/recipes/correcao_correntes.html -->
<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Visualizar Excel — Correção de correntes</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 20px; }
    .box { background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:16px; max-width: 1100px; margin:auto; }
    .tbl { border-collapse: collapse; width: 100%; }
    .tbl th, .tbl td { border:1px solid #e5e7eb; padding:8px 10px; text-align:left; font-size:14px; }
    .tbl thead th { background:#f8fafc; position: sticky; top: 0; }
    .muted { color:#64748b; font-size:12px; }
    .error { color:#b00020; margin:8px 0 0; }
  </style>
</head>
<body>
  <div class="box">
    <h1>Visualizar dados do Excel</h1>
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <input type="file" name="arquivo" accept=".xlsx,.xls" required>
      <button type="submit">Carregar</button>
    </form>

    {% if erro %}
      <p class="error">{{ erro }}</p>
    {% endif %}

    {% if tabela_html %}
      <p class="muted">
        Aba: <strong>{{ sheet }}</strong> |
        Colunas: {{ columns|length }} |
        Linhas exibidas: {{ rows_shown }} de {{ rows_total }}
      </p>
      <div class="table-wrap">
        {{ tabela_html|safe }}
      </div>
    {% endif %}
  </div>
</body>
</html>
